(function(e,t){"use strict";String.prototype.isNumeric=function(){if(-1===Math.sign(this))return!1;let e=this.replace(/\./g,"").replace(",",".").replace(/\n|\r|\t|\s/g,"");return!isNaN(parseFloat(e))&&isFinite(e)},String.prototype.trimCar=function(e){let t=new RegExp("^"+e),a=new RegExp(e+"$");return this.replace(t,"").replace(a,"")},String.prototype.trimall=function(){return this.replace(/\s*/gi,"")},String.prototype.braille=function(e){let t=this.trimCar("-");for(var a={BLANK:10240,1:10241,12:10243,123:10247,1234:10255,12345:10271,123456:10303,1234567:10367,12345678:10495,1234568:10431,123457:10335,1234578:10463,123458:10399,12346:10287,123467:10351,1234678:10479,123468:10415,12347:10319,123478:10447,12348:10383,1235:10263,12356:10295,123567:10359,1235678:10487,123568:10423,12357:10327,123578:10455,12358:10391,1236:10279,12367:10343,123678:10471,12368:10407,1237:10311,12378:10439,1238:10375,124:10251,1245:10267,12456:10299,124567:10363,1245678:10491,124568:10427,12457:10331,124578:10459,12458:10395,1246:10283,12467:10347,124678:10475,12468:10411,1247:10315,12478:10443,1248:10379,125:10259,1256:10291,12567:10355,125678:10483,12568:10419,1257:10323,12578:10451,1258:10387,126:10275,1267:10339,12678:10467,1268:10403,127:10307,1278:10435,128:10371,13:10245,134:10253,1345:10269,13456:10301,134567:10365,1345678:10493,134568:10429,13457:10333,134578:10461,13458:10397,1346:10285,13467:10349,134678:10477,13468:10413,1347:10317,13478:10445,1348:10381,135:10261,1356:10293,13567:10357,135678:10485,13568:10421,1357:10325,13578:10453,1358:10389,136:10277,1367:10341,13678:10469,1368:10405,137:10309,1378:10437,138:10373,14:10249,145:10265,1456:10297,14567:10361,145678:10489,14568:10425,1457:10329,14578:10457,1458:10393,146:10281,1467:10345,14678:10473,1468:10409,147:10313,1478:10441,148:10377,15:10257,156:10289,1567:10353,15678:10481,1568:10417,157:10321,1578:10449,158:10385,16:10273,167:10337,1678:10465,168:10401,17:10305,178:10433,18:10369,2:10242,23:10246,234:10254,2345:10270,23456:10302,234567:10366,2345678:10494,234568:10430,23457:10334,234578:10462,23458:10398,2346:10286,23467:10350,234678:10478,23468:10414,2347:10318,23478:10446,2348:10382,235:10262,2356:10294,23567:10358,235678:10486,23568:10422,2357:10326,23578:10454,2358:10390,236:10278,2367:10342,23678:10470,2368:10406,237:10310,2378:10438,238:10374,24:10250,245:10266,2456:10298,24567:10362,245678:10490,24568:10426,2457:10330,24578:10458,2458:10394,246:10282,2467:10346,24678:10474,2468:10410,247:10314,2478:10442,248:10378,25:10258,256:10290,2567:10354,25678:10482,2568:10418,257:10322,2578:10450,258:10386,26:10274,267:10338,2678:10466,268:10402,27:10306,278:10434,28:10370,3:10244,34:10252,345:10268,3456:10300,34567:10364,345678:10492,34568:10428,3457:10332,34578:10460,3458:10396,346:10284,3467:10348,34678:10476,3468:10412,347:10316,3478:10444,348:10380,35:10260,356:10292,3567:10356,35678:10484,3568:10420,357:10324,3578:10452,358:10388,36:10276,367:10340,3678:10468,368:10404,37:10308,378:10436,38:10372,4:10248,45:10264,456:10296,4567:10360,45678:10488,4568:10424,457:10328,4578:10456,458:10392,46:10280,467:10344,4678:10472,468:10408,47:10312,478:10440,48:10376,5:10256,56:10288,567:10352,5678:10480,568:10416,57:10320,578:10448,58:10384,6:10272,67:10336,678:10464,68:10400,7:10304,78:10432,8:10368},n=e&&e||a,r=e&&t.split("")||t.split("-"),c=r.length,o=0;o!==c;o++){if(!n[r[o]])return'caractère "'+r[o]+" ; "+r[o].charCodeAt()+'" non défini';e&&r.splice(o,1,a[e[r[o]]])||r.splice(o,1,a[r[o]])}return String.fromCharCode.apply(String,r)},HTMLElement.prototype.hasParent=function(e){e=Array.isArray(e)&&e||[e];for(var t,a,n=e.length,r=0;r!==n;r++)for(t=this.parentElement,a=t.tagName.toLowerCase();t&&"math"!==a;){if(t.tagName.toLowerCase()===e[r])return!0;t=t.parentElement,a=t.tagName.toLowerCase()}return!1},Object.prototype.hasChild=function(e){e=Array.isArray(e)&&e||[e];for(var t=e.length,a=0;a!==t;a++){var n=this.getElementsByTagName(e[a]);if(n[0]||this.tagName.toLowerCase()===e[a])return!0}return!1};var a,n={hasParent:function(e,t){t=Array.isArray(t)&&t||[t];for(var a,n,r=t.length,c=0;c!==r;c++)for(a=e.parentElement,n=a.tagName.toLowerCase();a&&"math"!==n;){if(a.tagName.toLowerCase()===t[c])return!0;a=a.parentElement,n=a.tagName.toLowerCase()}return!1},hasChild:function(e,t){t=Array.isArray(t)&&t||[t];for(var a=t.length,n=0;n!==a;n++){var r=e.getElementsByTagName(t[n]);if(r[0]||e.tagName.toLowerCase()===t[n])return!0}return!1},nbChildrens:function(e){return e.querySelectorAll("*").length},getElementsByContainTagName:function(e,t){t=Array.isArray(t)&&t||[t];for(var a=[],n=e.getElementsByTagName("*"),r=n.length,c=0;c!==r;c++)for(var o=n[c].tagName.toUpperCase(),i=t.length,l=0;l!==i;l++)t[l]=t[l].toUpperCase(),-1!==o.indexOf(t[l])&&a.push(n[c]);return a},block:function(e,a,n){a===t&&(a=i.caracMath.blocks.open),n===t&&(n=i.caracMath.blocks.close);var r=document.createElement("bloc"),c=document.createElement("blocOuverture"),o=document.createElement("blocFermeture");return c.appendChild(document.createTextNode(a)),o.appendChild(document.createTextNode(n)),r.appendChild(c),r.appendChild(document.createTextNode("\n")),r.appendChild(e),r.appendChild(document.createTextNode("\n")),r.appendChild(o),r},_extendDefaults:function(e,t){var a;for(a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);return e}},r={},c=function(e){this._mesFonctions=n,this._writeEq=C,r={remplaceFormule:!1,coupureFormule:0,codeBrailleMath:"fr",codeSysteme:"SI",matriceLineaire:!1,maxCaracCell:20,chimie:!1},e?"object"==typeof e?(r=n._extendDefaults(r,e),e="math"):arguments[1]&&"object"==typeof arguments[1]&&(r=n._extendDefaults(r,arguments[1])):e="math";var t=e&&document.querySelectorAll(e),c=t.length,o=0;for(this._formules=t;o!==c;o++){i=allVar[r.codeBrailleMath].mathBraille,t[o].setAttribute("aria-hidden",!0);var l=t[o].parentNode,m=document.createElement("math"),d=document.createElement("span");m.innerHTML=t[o].innerHTML,C._supprimeprefix(m),C._superflus(m),C._inutile(m),C._tableSeul(m),C._mspace(m),C._espace(m),C._menclose(m),r.chimie&&C._moverChimie(m),r.chimie&&C._munderChimie(m),r.chimie&&C._munderoverChimie(m),"nemeth"===r.codeBrailleMath&&(C._numDecimalNemeth(m),C._espaceNemeth(m)),a=C._boolHardMatrice(m),C._ajoutmfenced(m),C._pbBlocs(m),C._pbIntegrale(m),C._newMfracBloc(m),C._newMsqrtBloc(m),C._newMrootBloc(m),C._reecritureMultiscripts(m),C._newMmultiscriptsBloc(m),C._newMsubsupBloc(m),C._newMunderover(m),C._newMsupBloc(m),C._newMsubBloc(m),C._newPlacementMultiscript(m),C._newMfracWrite(m),C._newMsqrtWrite(m),C._newMrootWrite(m),C._newIndiceExposantWrite(m),C._newBlocBase(m);try{C._mover(m,"mover")}catch(e){}try{C._munder(m)}catch(e){}C._mfenced(m),C._mn(m),C._mo(m),C._mi(m),C._mtext(m),(r.matriceLineaire||a)&&C._matriceLineaire(m),C._writeform(m),d.innerHTML=m.innerHTML,d.classList.add("js-mathmlConverti"),l.insertBefore(d,t[o].nextSibling),r.remplaceFormule?t[o].setAttribute("style","display:none"):t[o].removeAttribute("style")}},o=function(e,t){t=t&&t||"fr";for(var a=document.querySelectorAll(e),n=a.length,r=0;r!==n;r++){var c=allVar[t].TBdbt;a[r].textContent=a[r].textContent.braille(c)}},i={};const l="-124578-",m="-1234567-",d="-1278-",s="-12345678-",p=l.braille(),u=m.braille(),h=d.braille(),g=s.braille(),f=String.fromCharCode(10240);let C={_munderoverChimie:function(e){for(var t=e.getElementsByTagName("munderover"),a=0,n=t.length;a<n;a++){let e=t[a].parentNode,n=t[a].children;if(8652===n[0].textContent.trim().charCodeAt()){let r=document.createElement("mfenced"),c=document.createElement("mrow");r.appendChild(n[2]),r.appendChild(document.createTextNode("-23-")),r.appendChild(n[1]),c.appendChild(n[0]),c.appendChild(r),e.replaceChild(c,t[a])}}},_menclose:function(e){for(var t=e.getElementsByTagName("menclose"),a=t.length;a--;){let e=t[a].parentNode;switch(t[a].getAttribute("notation")){case"radical":let n=document.createElement("msqrt");n.innerHTML=t[a].innerHTML,e.replaceChild(n,t[a]);break;default:let r=document.createElement("mrow");r.innerHTML=t[a].innerHTML,e.replaceChild(r,t[a])}}},_moverChimie:function(e){for(var t=e.getElementsByTagName("mover"),a=t.length;a--;){let e=t[a].children,n=t[a].parentNode;if(8652===e[0].textContent.trim().charCodeAt()){let r=document.createElement("mfenced"),c=document.createElement("mrow");r.appendChild(e[1]),r.appendChild(document.createTextNode("-23-")),r.appendChild(document.createTextNode("-5-2-")),c.appendChild(e[0]),c.appendChild(r),n.replaceChild(c,t[a])}else if("mi"===e[1].tagName.toLowerCase()){let n=document.createElement("mfenced"),r=document.createElement("mi");r.innerHTML=e[1].innerHTML,n.appendChild(r),t[a].replaceChild(n,e[1])}else{let r=document.createElement("mrow");r.appendChild(e[0]),r.appendChild(e[0]),n.replaceChild(r,t[a])}}},_munderChimie:function(e){for(var t=e.getElementsByTagName("munder"),a=0,n=t.length;a<n;a++){let e=t[a].children;if("mo"===e[1].tagName.toLowerCase()){let e=t[a].parentNode,n=document.createElement("mrow");n.innerHTML=t[a].innerHTML,e.replaceChild(n,t[a])}}},_mspace:function(e){for(var t=e.getElementsByTagName("mspace");t[0];){var a=t[0].parentNode,n=document.createElement("mi");n.textContent=" ",a.replaceChild(n,t[0])}},_espace:function(e){var t=e.querySelectorAll("mtext");t.forEach(e=>{160===e.textContent.charCodeAt()&&(e.textContent=" ")})},_numDecimalNemeth:function(e){for(var t=e.getElementsByTagName("mo"),a=t.length,n=0;n!==a;n++){var c=t[n];if(","===c.textContent.trim()&&"SI"===r.codeSysteme)if("mn"===c.previousElementSibling.tagName.toLowerCase()&&"mn"===c.nextElementSibling.tagName.toLowerCase())c.textContent=".";else if(160!==c.nextElementSibling.textContent.charCodeAt()){var o=document.createElement("space-bloc"),l=c.parentNode;o.appendChild(document.createTextNode(i.caracMath.espaceInsecable)),l.insertBefore(o,c.nextSibling)}}},_espaceNemeth:function(e){for(var t,a=e.getElementsByTagName("mo"),r=a.length,c=0;c!==r;){var o=n.hasParent(a[c],["msub","msup"]);if(160===a[c].textContent.charCodeAt()&&!o){var l=a[c].parentNode;t=document.createElement("space-bloc"),t.appendChild(document.createTextNode(i.caracMath.espaceInsecable)),l.replaceChild(t,a[c]),r--,c--}c++}},_pbIntegrale:function(e){for(var t=e.getElementsByTagName("msubsup"),a=t.length,n=0;n!==a;n++){var r=t[n].children,c=t[n].nextElementSibling,o=t[n].parentNode;if(8747===r[0].textContent.charCodeAt()&&c&&"mn"===c.tagName.toLowerCase()){for(o.insertBefore(document.createTextNode(i.caracMath.blocks.open),t[n].nextSibling);c&&"d"!==c.textContent;)c=c.nextElementSibling;c&&"mi"===c.nextElementSibling.tagName&&o.insertBefore(document.createTextNode(i.caracMath.blocks.close),c)}}},_pbBlocs:function(e){for(var t=["msub","msup"],a=["cos","sin","lim","ch","sh","ln","log","Card","tan","arctan","arcsin","arccos","arccotan"],r=e.getElementsByTagName("mi"),c=r.length,o=0;o!==c;o++){var l,m,d,s=r[o].textContent.trimall(),p=r[o].parentNode;if(-1!==a.indexOf(s)){if("lim"===s){for(;"munder"!==p.tagName.toLowerCase();)p=p.parentNode;if("mfrac"===p.nextElementSibling.tagName.toLowerCase()){var u=p.nextElementSibling;p=p.parentNode;var h=document.createElement("mfrac");h.innerHTML=u.innerHTML,p.replaceChild(n.block(h),u)}continue}if(-1===t.indexOf(p.tagName.toLowerCase())&&(p=r[o]),l=p.nextElementSibling,m=l,l&&"mfenced"===l.tagName.toLowerCase()||l&&-1!==l.textContent.indexOf("(")||l&&n.nbChildrens(l)>1)continue;if("mfrac"===p.nextElementSibling.tagName.toLowerCase()){u=p.nextElementSibling,p=p.parentNode,h=document.createElement("mfrac"),h.innerHTML=u.innerHTML,p.replaceChild(n.block(h),u);continue}for(;m&&"mo"!==m.tagName.toLowerCase()&&1===m.textContent.trimall().length;)d=m,m=m.nextElementSibling;m?(m=m.previousElementSibling,p.parentNode.insertBefore(document.createTextNode(i.caracMath.blocks.open),l),p.parentNode.insertBefore(document.createTextNode(i.caracMath.blocks.close),m.nextSibling)):d&&(p.parentNode.insertBefore(document.createTextNode(i.caracMath.blocks.open),l),p.parentNode.insertBefore(document.createTextNode(i.caracMath.blocks.close),d.nextSibling))}}},_tableSeul:function(e){var t=e.getElementsByTagName("mtable"),a=document.createElement("mtable-bloc");if(t.length>0&&1===e.children.length){var n=e.children[0].tagName,r=t[0].parentNode;if("mtable"===n.toLowerCase()){for(var c=t[0].getElementsByTagName("mtr"),o=c.length,i=0;i!==o;i++)i!==o-1&&c[i].appendChild(document.createTextNode(s));for(;c[0];)a.appendChild(c[0]);r.replaceChild(a,t[0])}}},_boolHardMatrice:function(e){var t=e.getElementsByTagName("mtable");if(t.length>1)return!0;if(0===t.length)return!1;for(var a=t[0].getElementsByTagName("mtd"),n=a.length,c=0,o=0;c!==n;c++){var i=a[c].textContent.replace(/\s*/gi,"").length;o<=i&&(o=i)}return o>=r.maxCaracCell},_supprimeprefix:function(e){let t=e.querySelectorAll("*");t.forEach(e=>{let t=e.tagName.split(":"),a=e.parentNode;if(t.length>1){let n=document.createElement(t[1]);n.innerHTML=e.innerHTML,a.replaceChild(n,e)}})},_inutile:function(e){for(var t=["annotation-xml","annotation"],a=t.length,n=0;n!==a;n++)for(var r=e.getElementsByTagName(t[n]);r[0];){var c=r[0].parentNode;c.removeChild(r[0])}},_superflus:function(e){let t=["mstyle","annotation"],a=t.length,n=0;document.createDocumentFragment();for(;n!==a;n++){let a=e.getElementsByTagName(t[n]);for(;a[0];){let e=a[0].children,t=a[0].parentNode,n=document.createElement("mrow");for(;e[0];)n.appendChild(e[0]);t.replaceChild(n,a[0])}}},_ajoutmfenced:function(e){let t=e.querySelectorAll("mo");const a=["(","[","{","|","‖"],r=[")","]","}","|","‖"];t.forEach(e=>{let t=document.createElement("mfenced"),c=e.parentNode,o=a.indexOf(e.textContent);e.nextElementSibling;-1!==o&&e.nextElementSibling&&("mtable"===e.nextElementSibling.tagName.toLowerCase()||n.hasChild(e.nextElementSibling,"mtable"))&&(t.setAttribute("open",a[o]),t.setAttribute("close",""),t.appendChild(e.nextElementSibling),e.nextElementSibling&&e.nextElementSibling.textContent===r[o]&&(t.setAttribute("close",r[o]),c.removeChild(e.nextElementSibling)),c.replaceChild(t,e))})},_reecritureMultiscripts:function(e){let t=e.querySelectorAll("mmultiscripts");t.forEach(e=>{let t=e.children,a=[];"mprescripts"===t[1].tagName.toLowerCase()?(a.push(document.createElement("none")),a.push(document.createElement("none")),a.push(t[1]),a.push(t[2]),a.push(t[3])):(a.push(t[1]),a.push(t[2]),a.push(t[3]),a.push(t[4]),a.push(t[5])),a.forEach(t=>e.appendChild(t))})},_newMmultiscriptsBloc:function(e){for(var t=e.getElementsByTagName("mmultiscripts"),a=t.length,n=0;n!==a;n++){for(var r=t[n].children,c=document.createElement("mmultiscripts"),o=0,i=r.length;o!==i;o++){var l=C._newNiveauIndiceExposant(r[o]),m=document.createElement(r[o].tagName.toLowerCase());if(m.innerHTML=r[o].innerHTML,-1!==l){var d=document.createElement("blocmulti-"+l);C._conditionsIndiceNum(r[0],r[1],l)&&1===o&&(d=document.createElement("blocIndiceNum-"+l)),d.appendChild(m),c.appendChild(d)}else 0===o?(d=document.createElement("blocbase"),d.appendChild(m),c.appendChild(d)):c.appendChild(m)}t[n].innerHTML=c.innerHTML}},_newPlacementMultiscript:function(e){for(var t=e.getElementsByTagName("mmultiscripts");t[0];){var a=t[0].parentElement,c=document.createElement("mmultiscripts-f"),o=t[0].children;r.chimie?(c.appendChild(o[0]),c.appendChild(document.createTextNode(i.caracMath.point6)),c.appendChild(o[3]),c.appendChild(document.createTextNode(i.caracMath.point6)),c.appendChild(o[3]),c.appendChild(o[0]),c.appendChild(o[0])):(c.appendChild(o[5]),c.appendChild(o[4]),c.appendChild(o[0]),c.appendChild(o[0]),c.appendChild(o[0])),(t[0].nextElementSibling||t[0].previousElementSibling)&&(c=n.block(c)),a.replaceChild(c,t[0])}},_mfenced:function(e){for(var t,c,o,l,m,d,s=e.getElementsByTagName("mfenced");s[0];){if(d=document.createElement("mfenced-block"),t=s[0].getAttribute("open"),null===t&&(t="("),1===t.split("").length&&(t=t.charCodeAt()),c=s[0].getAttribute("close"),null===c&&(c=")"),1===c.split("").length&&(c=c.charCodeAt()),l=s[0].getElementsByTagName("mtable"),m=s[0].parentNode,o=s[0].getAttribute("separators"),o){var p,u=o.split(""),h=s[0].children,g=0;let e=document.createElement("mrow");for(;h[0];){let t=document.createElement("mo");u[g]=u[g]||p,t.appendChild(document.createTextNode(u[g])),p=u[g]&&u[g],e.appendChild(h[0]),h[0]&&e.appendChild(t),g++}s[0].appendChild(e)}d.innerHTML=s[0].innerHTML;var f=0!==l.length&&(r.matriceLineaire||a);switch(t){case 40:t=f&&i.caracMath.grandeparenthese2.open||i.caracMath.parenthese.open;break;case 91:t=f&&i.caracMath.grandcrochet2.open||i.caracMath.crochet.open;break;case 93:t=f&&i.caracMath.grandcrochet2.close||i.caracMath.crochet.close;break;case 123:t=f&&i.caracMath.grandeaccolade.open||""!==c&&i.caracMath.accolade.open||i.caracMath.grandeaccolade.open;break;case 8739:case 124:t=f&&i.caracMath.grandebarre.open||i.caracMath.barre.open;break;case 8214:case 8741:case"||":t=f&&i.caracMath.grandedoublebarre.open||i.caracMath.doublebarre.open;break;case 10214:t=i.caracMath.crochetdouble.open}switch(c){case 41:c=f&&i.caracMath.grandeparenthese2.close||i.caracMath.parenthese.close;break;case 93:c=f&&i.caracMath.grandcrochet2.close||i.caracMath.crochet.close;break;case 91:c=f&&i.caracMath.grandcrochet2.open||i.caracMath.crochet.open;break;case 125:c=f&&i.caracMath.grandeaccolade.close||i.caracMath.accolade.close;break;case 124:c=f&&i.caracMath.grandebarre.close||i.caracMath.barre.close;break;case 8214:case 8741:case"||":c=f&&i.caracMath.grandedoublebarre.close||i.caracMath.doublebarre.close;break;case 10215:c=i.caracMath.crochetdouble.close}!r.matriceLineaire&&!a&&C._matriceBlock(t,c,d),m.replaceChild(n.block(d,t,c),s[0])}},_matriceBlock:function(e,t,a){for(var n,r,c,o,p,u,h,g,f=a.getElementsByTagName("mtable"),C=f.length,b=0;b!==C;b++)for(n=f[b].parentNode,n.insertBefore(document.createTextNode(m),f[b]),t&&n.insertBefore(document.createTextNode(d),f[b]),c=f[b].getElementsByTagName("mtr"),u=c.length,h=0;h!==u;h++)for(r=t&&t+s+e||s,h!==u-1&&f[b].insertBefore(document.createTextNode(r),c[h].nextSibling),o=c[h].getElementsByTagName("mtd"),p=o.length,g=0;g!==p;g++)n=o[g].parentNode,0===o[g].textContent.trim().length&&o[g].appendChild(document.createTextNode(i.caracMath.matrice.caseVide)),g!==p-1&&n.insertBefore(document.createTextNode(i.caracMath.espaceInsecable),o[g].nextSibling),n.insertBefore(document.createTextNode(l),o[g].nextSibling),n.insertBefore(document.createTextNode(l),o[g]);return a},_matriceLineaire:function(e){for(var t,a,n,r,c,o,l=e.getElementsByTagName("mtable"),m=l.length,d=0;d!==m;d++){for(t=l[d].getElementsByTagName("mtr"),r=t.length,c=0;c!==r;c++)c!==r-1&&t[c].appendChild(document.createTextNode(i.caracMath.matrice.sepLigne+i.caracMath.espaceInsecable));for(a=l[d].getElementsByTagName("mtd"),n=a.length,o=0;o!==n;o++)0===a[o].textContent.trim().length&&a[o].appendChild(document.createTextNode(i.caracMath.matrice.caseVide)),o!==n-1&&a[o].appendChild(document.createTextNode(i.caracMath.espaceInsecable))}},_newMsubsupBloc:function(e,t){t=t&&t||"msubsup";let a=e.getElementsByTagName(t),r="munderover"===t?"blocunderover-":"blocsubsup-",c=i.caracMath.indicateurBase&&i.caracMath.indicateurBase||"";for(;a[0];){let e=a[0].parentNode,o=document.createElement(t+"-f"),i=C._newNiveauIndiceExposant(a[0].children[1]),l=C._newNiveauIndiceExposant(a[0].children[2]),m=-1===l&&document.createElement("bloc")||document.createElement(r+l),d=-1===i&&document.createElement("bloc")||document.createElement(r+i);d=C._conditionsIndiceNum(a[0].children[0],a[0].children[1],i)&&document.createElement("blocIndiceNum-"+i)||d,m.appendChild(a[0].children[2]),d.appendChild(a[0].children[1]),o.appendChild(a[0].children[0]),o.appendChild(d),o.appendChild(m),o=n.block(o,"",c),e.replaceChild(o,a[0])}},_majus:function(e,t){for(var a=e.getElementsByTagName(t),n=a.length,c=0;c!==n;c++){let e=a[c].getAttribute("mathvariant")&&"script"===a[c].getAttribute("mathvariant"),t=a[c].getAttribute("mathvariant")&&"double-struck"===a[c].getAttribute("mathvariant");if(e&&(a[c].textContent=a[c].textContent.toLowerCase()),";"===a[c].textContent.trim()&&r.chimie)a[c].textContent=i.caracMath.point6+i.caracDec[a[c].textContent.trim().charCodeAt()];else if(" "===a[c].textContent)a[c].textContent=i.caracMath.espaceInsecable;else{var o=a[c].textContent.length>1&&a[c].textContent.trim().split("")||a[c].textContent.split(""),l="",m=o.length,d=0;for(a[c].textContent="";d<m;d++){let n;n=r.chimie?i.caracDec[o[d].charCodeAt()]&&i.caracDec[o[d].charCodeAt()].chimie?i.caracDec[o[d].charCodeAt()].chimie:i.caracDec[o[d].charCodeAt()]:i.caracDec[o[d].charCodeAt()]&&i.caracDec[o[d].charCodeAt()].math?i.caracDec[o[d].charCodeAt()].math:i.caracDec[o[d].charCodeAt()],l=n||o[d],l=e&&i.caracMath.majusculeronde+l||l,l=t&&i.caracMath.majuscule+l||l,a[c].textContent+=l}}}},_mi:function(e){C._majus(e,"mi")},_mo:function(e){C._majus(e,"mo")},_mtext:function(e){C._majus(e,"mtext")},_mn:function(e){if("ueb"===r.codeBrailleMath)for(var t=[",","."],a=e.getElementsByTagName("mn"),n=a.length,c=0;c!==n;c++){var o=a[c].parentNode,l=a[c].previousElementSibling;l?l&&-1===t.indexOf(l.textContent.trim())&&o.insertBefore(document.createTextNode(i.caracMath.indicateurNumerique),a[c]):o.insertBefore(document.createTextNode(i.caracMath.indicateurNumerique),a[c])}C._majus(e,"mn")},_mover:function(e,t){t=t||"mover";for(var a=e.getElementsByTagName(t),c=!1;a[0];){var o=a[0].getElementsByTagName("mtable");0!==o.length&&C._tableUnder(a[0]);var l=document.createElement(t+"bloc"),m=a[0].parentNode,d=a[0].children,s=String(d[1].textContent.trim().charCodeAt()),p="",u=Object.keys(i.caracDec.susouscrit);if(-1!==u.indexOf(s))"munder"===t.toLowerCase()&&l.appendChild(document.createTextNode(i.caracMath.majuscule)),l.appendChild(document.createTextNode(i.caracDec.susouscrit[s])),n.hasChild(d[0],"mo")&&"mfenced"!==d[0].tagName.toLowerCase()&&l.appendChild(n.block(d[0]))||l.appendChild(d[0]);else{var h=d[0],g=d[1];switch(t.toLowerCase()){case"mover":p=i.caracMath.suscrit,r.chimie&&(p="");break;case"munder":p=i.caracMath.souscrit,p=r.chimie&&i.caracMath.point6+p||p;break;case"mroot":a[0].nextElementSibling&&"mo"!==a[0].nextElementSibling.tagName.toLowerCase()&&(c=!0),p=i.caracMath.racine,h=d[1],g=d[0],l.appendChild(document.createTextNode(i.caracMath.exposant))}n.nbChildrens(h)>1&&!h.textContent.isNumeric()&&l.appendChild(n.block(h))||l.appendChild(h),l.appendChild(document.createTextNode(p)),n.nbChildrens(g)>1&&!g.textContent.isNumeric()&&l.appendChild(n.block(g))||l.appendChild(g)}l=c&&n.block(l)||l,m.replaceChild(l,a[0])}},_tableUnder:function(e){for(var t=document.createElement("mrow"),a=e.getElementsByTagName("mtable"),n=a[0].getElementsByTagName("mtr"),r=n.length,c=0;c!==r;c++)c!==r-1&&n[c].appendChild(document.createTextNode("-2-"));for(var o=a[0].parentNode;n[0];)t.appendChild(n[0]);return o.replaceChild(t,a[0]),e},_munder:function(e){C._mover(e,"munder")},_newMunderover:function(e){C._newMsubsupBloc(e,"munderover")},_newMfracBloc:function(e){for(var t=e.getElementsByTagName("mfrac");t[0];){var a=C._boolFracComplexity(t[0]),n=t[0].parentNode,r=document.createElement("mfrac-"+a),c=t[0].getAttribute("bevelled");c&&r.setAttribute("bevelled",c),r.innerHTML=t[0].innerHTML,n.replaceChild(r,t[0])}},_newMfracWrite:function(e){for(var t=n.getElementsByContainTagName(e,"mfrac"),a=i.caracMath.indicateurBase&&i.caracMath.indicateurBase||"",r=0,c=t.length;r<c;r++){var o=t[r],l=o.tagName.split("-"),m=document.createElement("bloc"),d=document.createElement("sep"),s=["msup","msub"],p=o.parentNode,u=o.children,h=u[0],g=u[1],f=2===h.children.length&&h.children[0].textContent.trimall().length>1,C=2===g.children.length&&g.children[0].textContent.trimall().length>1,b="";if(i.caracMath.indicateurFraction){var N=i.caracMath.indicateurFraction[l[1]],x=N.open,E=N.close,M=o.getAttribute("bevelled");b=M&&i.caracMath.fraction[l[1]].oblique||i.caracMath.fraction[l[1]].horizontale}else b=i.caracMath.fraction;d.appendChild(document.createTextNode(b)),d=-1!==s.indexOf(h.tagName.split("-")[0])&&n.block(d,a,"")||d,h=n.nbChildrens(h)>1&&!f&&n.block(h)||h,g=n.nbChildrens(g)>1&&!C&&n.block(g)||g,m.appendChild(h),m.appendChild(d),m.appendChild(g),m=i.caracMath.indicateurFraction&&n.block(m,x,E)||m,p.replaceChild(m,o)}},_boolFracComplexity:function(e){var t=e.children[0],a=e.children[1],n=t.getElementsByTagName("mfrac"),r=a.getElementsByTagName("mfrac"),c=n.length,o=r.length,i=["simple","complexe","hypercomplexe"],l=0;if(e.previousElementSibling&&"mn"===e.previousElementSibling.tagName.toLowerCase()){var m=e.parentElement.tagName;if("mfrac"!==m)return"fractionnaire"}return"mfrac"!==t.tagName.toLowerCase()&&0===c&&"mfrac"!==a.tagName.toLowerCase()&&0===o?-1!==t.textContent.indexOf("/")||-1!==a.textContent.indexOf("/")?"complexe":"simple":(l=l<C._testEnfants(a)&&C._testEnfants(a)||l,l=l<C._testEnfants(t)&&C._testEnfants(t)||l,i[l])},_testEnfants:function(e){var t=0;if("mfrac"===e.tagName.toLowerCase())t="simple"===C._boolFracComplexity(e)?1:2;else if("msub"===e.tagName.toLowerCase()||"msup"===e.tagName.toLowerCase())t=0;else for(var a=e.children,n=0,r=a.length;n!==r;n++)"mfrac"===a[n].tagName.toLowerCase()&&(t="simple"===C._boolFracComplexity(a[n])||"fractionnaire"===C._boolFracComplexity(a[n])?1:2);return t},_countParent:function(e,t){for(var a=e.getElementsByTagName(t),n=a[0]&&a[0].parentElement,r=0;n&&"math"!==n.tagname.toLowerCase();)r++,n=n.parentElement;return 0===r?1e4:r},_virguleNemeth:function(e){for(var t=e.length,a=0;a!==t;a++)for(var n,r,c,o=e[a].getElementsByTagName("mo"),l=o.length,m=0;m!==l;){var d=o[m],s=d.nextElementSibling;switch(r=d.parentNode,n=document.createElement("mo-bloc"),c=s&&(160===s.textContent.charCodeAt()||"-BLANK-"===s.textContent),d.textContent.charCodeAt()){case 44:c&&n.appendChild(document.createTextNode(i.caracMath.separateurIndiceExposant.virgule)),c&&r.replaceChild(n,d),"-BLANK-"===s.textContent&&r.removeChild(s),l--,m--;break;case 59:c&&n.appendChild(document.createTextNode(i.caracMath.separateurIndiceExposant.pointvirgule)),c&&r.replaceChild(n,d),l--,m--}m++}},_newMsupBloc:function(e){for(var t=e.getElementsByTagName("msup");t[0];){var a=t[0].parentElement,n=C._newNiveauIndiceExposant(t[0].children[1]),r=document.createElement("msup-f"),c=-1===n&&document.createElement("bloc")||document.createElement("blocsubsup-"+n);r.innerHTML=t[0].innerHTML,c.appendChild(r.children[1]),a.replaceChild(r,t[0]),r.appendChild(c)}},_conditionsIndiceNum:function(e,t,a){var r=["log","sin","cos","arcsin","CO"],c=["∫"];return-1===c.indexOf(e.textContent.trimall())&&(!n.hasChild(t,["msub","msup","msubsup","mmultiscripts","blocIndiceNum"])&&(!(e.textContent.trimall().split("").length>1&&-1===r.indexOf(e.textContent.trimall()))&&!(-1===a||1!==a.split("").length||e.textContent.trimall().isNumeric()||!t.textContent.trimall().isNumeric())))},_newMsubBloc:function(e){for(var t=e.getElementsByTagName("msub");t[0];){var a=t[0].parentElement,n=C._newNiveauIndiceExposant(t[0].children[1]),r=document.createElement("msub-f"),c=-1===n&&document.createElement("bloc")||document.createElement("blocsubsup-"+n);c=C._conditionsIndiceNum(t[0].children[0],t[0].children[1],n)&&document.createElement("blocIndiceNum-"+n)||c,r.innerHTML=t[0].innerHTML,c.appendChild(r.children[1]),a.replaceChild(r,t[0]),r.appendChild(c)}},_newNiveauIndiceExposant:function(e){var t=e.tagName.split("-")[0],a=["none","mmultiscripts","mprescripts"];if(-1!==a.indexOf(t))return-1;for(var n=e.parentElement,r=n.tagName.split("-"),c=e,o="";"math"!==r[0].toLowerCase();){switch(r[0].toLowerCase()){case"msup":o+="e";break;case"msub":o+="i";break;case"mmultiscripts":var i=C._positionDansParent(c);2===i||5===i?o+="e":1!==i&&4!==i||(o+="i");break;case"munderover":case"msubsup":i=C._positionDansParent(c),1===i?o+="i":2===i&&(o+="e")}c=n,n=n.parentElement,r=n.tagName.split("-")}return""===o?-1:o},_positionDansParent:function(e){for(var t=e.parentElement,a=t.children,n=a.length,r=0;r!==n;r++)if(a[r]===e)return r;return-1},_newIndiceExposantWrite:function(e){for(var t=["msup","msub"],a=i.caracMath.indice,c=i.caracMath.exposant,o=i.caracMath.indicateurBase&&i.caracMath.indicateurBase||"",l=n.getElementsByContainTagName(e,["blocsubsup","blocmulti","blocIndiceNum","blocunderover"]),m=l.length,d=m-1;-1!==d;d--){var s=l[d],p=s.tagName.toLowerCase().split("-"),u=s.parentNode;if(p[1]&&("blocIndiceNum"!==p[0]||"fr"===r.codeBrailleMath)){var h=r.chimie&&"fr"===r.codeBrailleMath&&!n.hasParent(s,["mmultiscripts-f","mmultiscripts"]),g=p[1].split(""),f=(0===s.children[0].children.length||t.indexOf(-1!==p[0]))&&document.createElement(s.tagName.toLowerCase())||document.createElement("bloc");if(f.innerHTML=s.innerHTML,"blocunderover"===p[0]?(c=i.caracMath.suscrit,a=i.caracMath.souscrit):(a=!h&&i.caracMath.indice||"",c=i.caracMath.exposant),f=n.nbChildrens(f.children[0])>1&&n.block(f)||f,!s.previousElementSibling||"|"!==s.previousElementSibling.textContent.trim()){let e=0,t=g.length;for(;e!==t&&(f="e"===g[e].toLowerCase()&&n.block(f,c,"")||f,f="i"===g[e].toLowerCase()&&n.block(f,a,"")||f,"fr"!==r.codeBrailleMath);e++);}for(var C=s.nextElementSibling;C&&"bloc"===C.tagName.toLowerCase();)C=C.nextElementSibling;var b=["mi","mo","mn"];C&&-1!==b.indexOf(C.tagName.toLowerCase())&&(g.length>1&&(o=g[0]),f=n.block(f,"",o)),u.replaceChild(f,s)}}},_newBlocBase:function(e){for(var t=e.getElementsByTagName("blocbase"),a=i.caracMath.indicateurBase&&i.caracMath.indicateurBase||"";t[0];){var r=t[0].parentNode,c=document.createElement("blocbase-f");c.innerHTML=t[0].innerHTML,c=n.block(c,a,""),r.replaceChild(c,t[0])}},_newMsqrtBloc:function(e,t){t=t||"msqrt";for(var a=e.getElementsByTagName(t);a[0];){var n=a[0].parentNode,r=C._radicauxEmboites(a[0]),c=document.createElement(t+"-"+r);c.innerHTML=a[0].innerHTML,n.replaceChild(c,a[0])}},_radicauxEmboites:function(e){for(var t,a=0,n=e.parentNode;n;)t=n.tagName.toLowerCase().split("-"),("msqrt"===t[0]||"mroot"===t[0])&&a++,n=n.parentNode;return a},_newMsqrtWrite:function(e){var t,a=n.getElementsByContainTagName(e,"msqrt"),r=a.length;for(t=a[0]?r-1:-1;-1!==t;t--){var c=a[t],o=c.tagName.toLowerCase().split("-"),l=c.parentNode,m=document.createElement("bloc"),d=c.children,s=i.caracMath.racine,p=i.caracMath.ordreRadical&&i.caracMath.ordreRadical.repeat(o[1]),u=i.caracMath.finRacine;m.innerHTML=c.innerHTML,1===d.length?"mrow"!==d[0].tagName.toLowerCase()&&"mpadded"!==d[0].tagName.toLowerCase()||(m=n.nbChildrens(d[0])>1&&n.block(m)||m):m=n.block(m),m=u&&n.block(m,p+s,p+u)||n.block(m,s,""),l.replaceChild(m,c)}},_newMrootBloc:function(e){C._newMsqrtBloc(e,"mroot")},_newMrootWrite:function(e){var t,a=n.getElementsByContainTagName(e,"mroot"),r=a.length;for(t=a[0]?r-1:-1;-1!==t;t--){var c,o=a[t],l=o.tagName.toLowerCase().split("-"),m=o.parentNode,d=document.createElement("bloc"),s=document.createElement("bloc"),p=o.children,u=p[0],h=p[1],g=i.caracMath.racine,f=i.caracMath.ordreRadical&&i.caracMath.ordreRadical.repeat(l[1]),C=i.caracMath.finRacine,b=i.caracMath.indiceRadical;s.appendChild(u);var N=u.children;o.nextElementSibling&&"mo"!==o.nextElementSibling.tagName.toLowerCase()&&(c=!0),o.previousElementSibling&&"mo"!==o.previousElementSibling.tagName.toLowerCase()&&(c=!0),1===N.length?"mrow"!==N[0].tagName.toLowerCase()&&"mpadded"!==N[0].tagName.toLowerCase()||(s=n.nbChildrens(N[0])>1&&n.block(s)||s):N.length>=1&&(s=n.block(s)),s=C&&n.block(s,g,"")||n.block(s,g,""),d.appendChild(h),d.appendChild(s),d=C&&n.block(d,f+b,f+C)||n.block(d,i.caracMath.exposant,""),d=!C&&c&&n.block(d)||d,m.replaceChild(d,o)}},_retourChariotMatrice:function(e){var t,a,n,r,c,o="";t=e.textContent.split(""),a=t.indexOf(u);let l=-1===e.textContent.indexOf(g+i.caracMath.parenthese.open.braille())&&-1==e.textContent.indexOf(g+i.caracMath.crochet.open.braille())&&-1==e.textContent.indexOf(g+i.caracMath.barre.open.braille());for(-1!==a&&t.splice(a,1),n=t.indexOf(h),-1!==n?(t.splice(n,1),a=l?-1!==a&&a-2||0:-1!==a&&a-1||0):a=-1!==a&&a||0,c=0;c!==a;c++)o+=f;for(r=t.indexOf(g);-1!==r;)t.splice(r,1,"<br/>"+o),r=t.indexOf(g,r+1);return t.join("")},_calculEspaceMTD:function(e){
var t=new RegExp(f+p+f,"g");e.textContent=e.textContent.replace(t,f+p);var a=new RegExp(g,"gi"),n=e.textContent.match(a)&&e.textContent.match(a).length+1;if(null===n)return e.textContent;for(var r,c,o,i,l,m,d=e.textContent.split(""),s=[],u=[],h=[],b=d.indexOf(p),N=d.indexOf(p,b+1);-1!==b;)l=N-b-1,s.push(l),h.push(N),b=d.indexOf(p,N+1),N=d.indexOf(p,b+1);for(r=s.length,c=r/n,u.length=c,u.fill(0),o=0;o!==r;o++)s[o]>u[o%c]&&(u[o%c]=s[o]);for(i=0;i!==r;i++)if(N=h[i],l=u[i%c]-s[i],m="",l>0){for(o=1;o<=l;o++)m+=f;d.splice(N,1,m)}return d=d.filter(C._filtremarque),d.join("")},_filtremarque:function(e){return e!==p},_indicateurNumerique:function(e){var t=e.textContent.split(""),a=["⠴","⠂","⠆","⠒","⠲","⠢","⠖","⠶","⠦","⠔"];-1!==a.indexOf(t[0])&&t.splice(0,0,i.caracMath.indicateurNumerique.braille());for(var n="BLANK".braille(),r=t.indexOf(n);-1!==r;)-1!==a.indexOf(t[r+1])&&t.splice(r+1,0,i.caracMath.indicateurNumerique.braille()),r=t.indexOf(n,r+1);return t.join("")},_writeform:function(e){e.textContent=e.textContent.trimall(),e.textContent=e.textContent.replace(/-EMPTY-/g,""),e.textContent=e.textContent.replace(/--/gi,"-"),e.textContent=e.textContent.braille(),e.textContent=C._petitsSoucis(e),!r.matriceLineaire&&!a&&(e.innerHTML=C._calculEspaceMTD(e)),e.innerHTML=C._retourChariotMatrice(e),"nemeth"===r.codeBrailleMath&&(e.innerHTML=C._indicateurNumerique(e)),e.innerHTML=0!==r.coupureFormule&&C._coupureFormule(e,r.coupureFormule)||e.innerHTML},_petitsSoucis:function(e){let t=e.textContent.replace(/⠈⠖⠖/g,"⠈⠰⠖⠆⠖");return t=t.replace(/⠈⠤⠤/g,"⠈⠰⠤⠆⠤"),t},_coupureFormule:function(e,t){if(-1!==e.innerHTML.indexOf("<br"))return e.innerHTML;t=parseInt(t);let a=e.textContent,n="",r="",c=i.caracMath.coupureFormule.braille()+"<br />";if(0!==t||t-1>0){let e=Math.floor(a.length/(t-1))+1;for(let o=0;o!==e;o++)r=o!==e-1&&a.slice(o*(t-1),(o+1)*(t-1))||a.slice(o*(t-1)),n+=o!==e-1&&r+c||r}return n}};e.Mathml2braille=c,e.Brailledirect=o})(this);