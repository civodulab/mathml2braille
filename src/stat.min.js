function stat(){document.querySelectorAll("p,#fstat,#fstat_texte").forEach(e=>e.classList.remove("good","bad"));for(var e=document.querySelectorAll(".js-mathmlConverti"),t=e.length,n=0,l=0,a=0,d=0;d!==t;d++){var i=e[d].parentElement,r=i.querySelector(".mathbraille2"),o=i.querySelector(".mathbraille"),c=new RegExp("⠐(<br[^>]+/>|<br[^>]+></br>)","g"),s=new RegExp("(<br[^>]+/>|<br[^>]+></br>)","g"),m=e[d].innerHTML.replace(c,"");m=m.replace(s,""),i.classList.remove("good","bad"),o?o&&o.textContent.trimall()===m?(i.classList.add("good"),n++):r&&r.textContent.trimall()===m?(i.classList.add("good"),n++):(i.classList.add("bad"),l++):i.classList.add("totest")}a=Math.round(100*n/(l+n)),100===a?document.getElementById("fstat").classList.add("good"):document.getElementById("fstat").classList.add("bad"),document.getElementById("stat").textContent=n+" équations bonnes sur "+(l+n)+" ("+a+"%)"}function stat_texte(){let e=document.querySelectorAll(".ecriture_auto"),t=0,n=0;e.forEach(e=>{let l=e.parentElement,a=l.querySelector(".texte_equation"),d=l.querySelector(".texte_equation2");if(a){let l=a.textContent.trim().replace(/\s/g," ");d=d&&d.textContent.trim().replace(/\s/g," "),l===e.textContent.trim()?(e.classList.add("good"),t++):d&&d===e.textContent.trim()?(e.classList.add("good"),t++):(e.classList.add("bad"),n++)}});let l=Math.round(100*t/(n+t));100===l?document.getElementById("fstat_texte").classList.add("good"):document.getElementById("fstat_texte").classList.add("bad"),document.getElementById("stat_texte").textContent=t+" équations bonnes sur "+(n+t)+" ("+l+"%)"}function option(){let e=document.getElementById("monForm");e.addEventListener("change",function(t){let n=document.getElementById("coupure").value,l=e.linear.checked,a=e.remplace.checked,d=e.ponctuations.checked,i=e.descMat.checked;document.querySelectorAll(".js-mathmlConverti, .ecriture_auto").forEach(e=>e.parentNode.removeChild(e));var r={coupureFormule:n,matriceLineaire:l,remplaceFormule:a},o={coupureFormule:n,matriceLineaire:l,remplaceFormule:a,chimie:!0},c={coupureFormule:n,matriceLineaire:!0,remplaceFormule:a},s={ponctuation:d,descMatrice:i},m={coupureFormule:n,matriceLineaire:!1,remplaceFormule:a};let u=new Mathml2braille(".js-math2braille",r);u.mathml2text(s);let p=new Mathml2braille(".js-matrice-lineaire",c);p.mathml2text(s);var b=new Mathml2braille(".js-matrice-non-lineaire",m);b.mathml2text();let f=new Mathml2braille(".js-chimie",o);f.mathml2text(s),stat(),stat_texte()})}function _createForm(){let e=document.createElement("form");e.setAttribute("id","monForm");let t=document.createElement("fieldset");t.setAttribute("id","fstat");let n=document.createElement("legend");n.textContent="Stats équations";let l=document.createElement("p");l.setAttribute("id","stat"),t.appendChild(n),t.appendChild(l),e.appendChild(t),t=document.createElement("fieldset"),t.setAttribute("id","fstat_texte"),n=document.createElement("legend"),n.textContent="Stats textes",l=document.createElement("p"),l.setAttribute("id","stat_texte"),t.appendChild(n),t.appendChild(l),e.appendChild(t),t=document.createElement("fieldset"),t.setAttribute("id","foption"),n=document.createElement("legend"),n.textContent="Options",t.appendChild(n),fieldset2=document.createElement("fieldset");let a=document.createElement("input");a.setAttribute("type","checkbox"),a.setAttribute("name","remplace"),a.setAttribute("id","remplace");let d=document.createElement("label");d.setAttribute("for","remplace"),d.textContent="Remplacer la formule",fieldset2.appendChild(a),fieldset2.appendChild(d),t.appendChild(fieldset2),fieldset2=document.createElement("fieldset"),a=document.createElement("input"),a.setAttribute("type","checkbox"),a.setAttribute("name","linear"),a.setAttribute("id","matLin"),d=document.createElement("label"),d.textContent="Matrice linéaire",d.setAttribute("for","matLin"),fieldset2.appendChild(a),fieldset2.appendChild(d),t.appendChild(fieldset2),fieldset2=document.createElement("fieldset"),a=document.createElement("input"),a.setAttribute("type","text"),a.setAttribute("name","coupure"),a.setAttribute("id","coupure"),a.setAttribute("maxlength","2"),a.setAttribute("size","2"),a.setAttribute("value","0"),d=document.createElement("label"),d.textContent="Césure équation",d.setAttribute("for","coupure"),fieldset2.appendChild(a),fieldset2.appendChild(d),t.appendChild(fieldset2),fieldset2=document.createElement("fieldset"),a=document.createElement("input"),a.setAttribute("type","checkbox"),a.setAttribute("name","ponctuations"),a.setAttribute("id","ponctuations"),d=document.createElement("label"),d.textContent="Ponctuations en texte",d.setAttribute("for","ponctuations"),fieldset2.appendChild(a),fieldset2.appendChild(d),t.appendChild(fieldset2),fieldset2=document.createElement("fieldset"),a=document.createElement("input"),a.setAttribute("type","checkbox"),a.setAttribute("name","descMat"),a.setAttribute("id","descMat"),d=document.createElement("label"),d.textContent="Tableaux (lignes et colonnes)",d.setAttribute("for","descMat"),fieldset2.appendChild(a),fieldset2.appendChild(d),t.appendChild(fieldset2),e.appendChild(t),document.body.insertBefore(e,document.body.firstChild)}_createForm(),stat(),stat_texte(),option();